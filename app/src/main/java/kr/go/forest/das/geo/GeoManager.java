package kr.go.forest.das.geo;

import android.widget.Toast;

import org.gdal.gdal.Band;
import org.gdal.gdal.Dataset;
import org.gdal.gdal.gdal;
import org.gdal.gdalconst.gdalconst;
import org.gdal.ogr.DataSource;
import org.gdal.ogr.Driver;
import org.gdal.ogr.Feature;
import org.gdal.ogr.FeatureDefn;
import org.gdal.ogr.FieldDefn;
import org.gdal.ogr.Geometry;
import org.gdal.ogr.Layer;
import org.gdal.ogr.ogr;
import org.gdal.osr.CoordinateTransformation;
import org.gdal.osr.SpatialReference;
import org.gdal.osr.osr;
import org.osmdroid.util.GeoPoint;

import java.io.File;
import java.util.ArrayList;
import java.util.List;

public class GeoManager {
    private static final GeoManager ourInstance = new GeoManager();

    public static GeoManager getInstance() {
        return ourInstance;
    }
    private SpatialReference merc = new SpatialReference();
    private SpatialReference wgs84 = new SpatialReference();
    private CoordinateTransformation trsform;

    private GeoManager() {
        // for Elevation Info(geotiff file)
        gdal.AllRegister();

        // for Shape file
        ogr.RegisterAll();

        merc.ImportFromProj4("+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ");
        wgs84.SetWellKnownGeogCS("WGS84");
        trsform = osr.CreateCoordinateTransformation(merc, wgs84);
    }

    private boolean CheckFile(String filepath) {
        File _file = new File(filepath);
        return _file.exists();
    }

    // Get Elevation Info
    // filepath : geotiff file path
    // positions : positions for elevation
    // return : Elevations (m)
    public int[] GetElevations(String filepath, ArrayList<Position> positions) {
        boolean _complete = true;
        int[] _return;

        if (!CheckFile(filepath)) return null;

        // geotiff file load and get Raster
        Dataset _elevationDataSet = gdal.Open(filepath, gdalconst.GA_ReadOnly);

        if (_elevationDataSet == null) {
            return null;
        }

        double[] _geoTransformsInDoubles = _elevationDataSet.GetGeoTransform();
        Band _rasterBand = _elevationDataSet.GetRasterBand(1);

        SpatialReference _src = new SpatialReference();
        _src.SetWellKnownGeogCS("WGS84");
        String _projection = _elevationDataSet.GetProjection();
        SpatialReference _dst = new SpatialReference(_projection);

        CoordinateTransformation _ct = new CoordinateTransformation(_src, _dst);

        int _count = positions.size();
        _return = new int[_count];

        for (int i = 0; i < _count; i++) {
            Position _position = positions.get(i);
            double _latitude = _position.latitude;
            double _longitude = _position.longitude;
            double[] _xy = _ct.TransformPoint(_longitude, _latitude);
            int _x = (int) (((_xy[0] - _geoTransformsInDoubles[0]) / _geoTransformsInDoubles[1]));
            int _y = (int) (((_xy[1] - _geoTransformsInDoubles[3]) / _geoTransformsInDoubles[5]));

            int[] flt = new int[2];
            int _readResult = _rasterBand.ReadRaster(_x, _y, 1, 1, flt);

            if (_readResult != 0) {
                _complete = false;
                break;
            }
        }

        _dst.delete();
        _ct.delete();
        _rasterBand.delete();
        _elevationDataSet.delete();

        if (!_complete) return null;

        return _return;
    }

    public ArrayList<Position> GetPositionsFromShapeFile(String filepath) {
        ArrayList<Position> _return = new ArrayList<Position>();

        if (!CheckFile(filepath)) return null;

        DataSource _ds = ogr.Open(filepath, true);

        if (_ds == null) {
            return null;
        }

        int _ds_count = _ds.GetLayerCount();

        for (int iLayer = 0; iLayer < _ds_count; iLayer++) {
            Layer _poLayer = _ds.GetLayer(iLayer);

            if (_poLayer == null) {
                return null;
            }

            long _featureCount = _poLayer.GetFeatureCount();

            for (int iFeature = 0; iFeature < _featureCount; iFeature++) {
                Feature _feature = _poLayer.GetFeature(iFeature);
                Geometry _geometry = _feature.GetGeometryRef();
                int srcType = _geometry.GetGeometryType();

                if (srcType == ogr.wkbPolygon) {
                    String _json = _geometry.ExportToJson();
                } else if (srcType == ogr.wkbMultiPoint) {

                }
            }
        }

        _ds.delete();
        return _return;
    }

    public int SaveShapeFile(String filepath, ArrayList<Position> positions) {
        // save file using ogr driver
        Driver drv = ogr.GetDriverByName("ESRI Shapefile");

        if (drv.TestCapability(ogr.ODrCCreateDataSource) == false) {
            //System.err.println( pszFormat + " driver does not support data source creation.");
            return -99;
        }

        File file = new File(filepath);
        if (file.exists())
            drv.DeleteDataSource(filepath);

        DataSource outputDs = drv.CreateDataSource(filepath);

        if (outputDs == null) {
            //System.err.println( pszFormat + " driver failed to create "+ pszDestDataSource );
            return -98;
        }

        SpatialReference _dst = new SpatialReference();
        _dst.SetWellKnownGeogCS("WGS84");
        Layer _outLayer = outputDs.CreateLayer(filepath, _dst);

        FieldDefn field_def = new FieldDefn("DN", ogr.OFTInteger);
        _outLayer.CreateField(field_def);

        // make geometry data
        Geometry _saveInfo = new Geometry(ogr.wkbMultiPoint);

        for (Position position : positions) {
            Geometry _point = new Geometry(ogr.wkbPoint);
            _point.AddPoint_2D(position.longitude, position.latitude);
            _saveInfo.AddGeometry(_point);
            _point.delete();
        }

        FeatureDefn _featureDefn = _outLayer.GetLayerDefn();
        Feature _feature = new Feature(_featureDefn);
        _feature.SetGeometry(_saveInfo);
        int res = _outLayer.CreateFeature(_feature);

        _saveInfo.delete();
        _feature.delete();
        _outLayer.delete();
        outputDs.delete();

        if (res != 0) {
            return res;
        }

        return 0;
    }

    public String makeWKT(ArrayList<GeoPoint> points)
    {
        return  null;
    }

    public GeoPoint getWGS84Points(double x, double y)
    {
            double[] _result = trsform.TransformPoint(x, y);
            GeoPoint _point = new GeoPoint(_result[1], _result[0]);

            return _point;
    }

    private double distance(double lat1, double lon1, double lat2, double lon2) {
        if ((lat1 == lat2) && (lon1 == lon2)) {
            return 0;
        }
        else {
            double theta = lon1 - lon2;
            double dist = Math.sin(Math.toRadians(lat1)) * Math.sin(Math.toRadians(lat2))
                         + Math.cos(Math.toRadians(lat1)) * Math.cos(Math.toRadians(lat2)) * Math.cos(Math.toRadians(theta));
            dist = Math.acos(dist);
            dist = Math.toDegrees(dist);
            dist = dist * 60 * 1.1515 * 1.609344;
            return (dist);
        }
    }

    public double getAreaFromPolygon()
    {
        //String wkt = "POLYGON ((14415874.05772892 4638455.18787222,14415874.05772892 4602997.0277381,14360214.31233228 4602997.0277381,14360214.31233228 4619529.01754682,14332384.43963396 4619529.01754682,14332384.43963396 4638455.18787222,14415874.05772892 4638455.18787222))";
        //String wkt = "POLYGON ((35.34427 127.80806, 35.34755 127.80423, 35.34922 127.80954, 35.34596 127.81233))";
        String wkt = "MULTIPOLYGON(((14425675.29361531 4457405.16085072,14425720.48932857 4457157.74233253,14425763.01337406 4456909.8409313,14425802.86575176 4456661.45668091,14425839.99080194 4456412.72923054,14425874.49984409 4456163.58879834,14425906.33721845 4455914.10521773,14425935.44726529 4455664.34831559,14425961.88564436 4455414.24831016,14425985.65235564 4455163.87502507,14426006.6917394 4454913.29827733,14426025.05945538 4454662.44828525,14426040.69984384 4454411.46465698,14426053.66856452 4454160.34740193,14426063.96561741 4453909.09652951,14426071.47968304 4453657.71204914,14426076.37774064 4453406.33354578,14426078.49281097 4453154.89123277,14426077.93621352 4452903.38511458,14426074.70794828 4452652.02454399,14426068.75235552 4452400.60016714,14426060.12509498 4452149.32132688,14426048.77050693 4451898.18801272,14426034.68859134 4451647.20021419,14426017.93500798 4451396.28814632,14425998.50975683 4451145.66112216,14425976.35717816 4450895.24935013,14425951.53293172 4450645.1225844,14425924.03701748 4450395.21103673,14425893.81377574 4450145.72399053,14425860.91886621 4449896.52188643,14425825.40794865 4449647.67446717,14425787.16970356 4449399.25146894,14425746.25979069 4449151.25286173,14425702.73386979 4448903.74837367,14425656.53628111 4448656.73796998,14425607.66702465 4448410.22161594,14425556.18176017 4448164.26903014,14425502.02482789 4447918.88017315,14425445.25188759 4447674.12475561,14425385.86293925 4447430.00273346,14425323.85798287 4447186.51406281,14425259.23701847 4446943.72844495,14425192.00004603 4446701.64583144,14425122.2027253 4446460.33591588,14425049.78939655 4446219.79864536,14424974.76005975 4445980.10370587,14424897.22603442 4445741.1813029,14424817.13166079 4445503.10111973,14424734.42127913 4445266.00256757,14424649.26186867 4445029.74611536,14424561.48645019 4444794.47116859,14424471.26200289 4444560.1079323,14424378.47720731 4444326.79580167,14424283.1877232 4444094.46498078,14424185.44921028 4443863.18512978,14424085.20600882 4443633.02590309,14423982.51377856 4443403.91750571,14423877.37251951 4443175.99931003,14423769.78223166 4442949.2015203,14423659.79857476 4442723.59378181,14423547.36588905 4442499.17601843,14423432.5398343 4442276.01786887,14423315.3204105 4442054.11925342,14423195.70761764 4441833.54980436,14423073.75711547 4441614.23972854,14422949.468904 4441396.25865629,14422822.84298322 4441179.67621269,14422693.93501289 4440964.42260614,14422562.68933324 4440750.63716429,14422429.16160403 4440538.3197982,14422293.35182526 4440327.40071799,14422155.31565669 4440118.0192405,14422015.05309829 4439910.10557567,14421872.50849033 4439703.72933454,14421727.7931523 4439498.89042721,14421580.90708419 4439295.65845928,14421431.85028601 4439094.10303172,14421280.62275778 4438894.08466451,14421127.28015921 4438695.74265227,14420971.76683056 4438499.07690084,14420814.19409136 4438304.15700513,14420654.56194156 4438110.91318178,14420492.81472143 4437919.41502481,14420329.06375048 4437729.66243957,14420163.30902868 4437541.72501553,14419995.49489632 4437355.60265613,14419825.73267285 4437171.29526569,14419654.0223583 4436988.80274955,14419480.30829292 4436808.2643708,14419304.70179619 4436629.54067506,14419127.20286812 4436452.77092272,14418947.81150871 4436277.95501602,14418766.52771796 4436105.0928583,14418583.4071556 4435934.18435395,14418398.50548139 4435765.22940847,14418211.76703558 4435598.36726945,14418023.24747792 4435433.45849924,14417833.00246816 4435270.64234336,14417641.0320063 4435109.9187054,14417447.33609231 4434951.2874902,14417251.91472622 4434794.74860383,14417054.87922752 4434640.30195361,14416856.17393645 4434488.01711134,14416655.85451277 4434337.96364606,14416453.97661621 4434190.00214058,14416250.48458705 4434044.2718279,14416045.43408501 4433900.70295669,14415838.88076983 4433759.434756,14415630.82464154 4433620.39747637,14415421.26570012 4433483.59103008,14415210.31526507 4433349.08498652,14414997.86201689 4433216.87925817,14414784.07293482 4433086.973759,14414568.83669938 4432959.36840452,14414352.26463004 4432834.13276405,14414134.41238655 4432711.1971021,14413915.22430919 4432590.70064022,14413694.75605766 4432472.50399533,14413473.00763201 4432356.74638899,14413250.09035169 4432243.42774136,14413025.94855698 4432132.47832653,14412800.63790762 4432023.96771721,14412574.1584036 4431917.96548487,14412346.56570466 4431814.33226306,14412117.85981083 4431713.20727232,14411888.09638183 4431614.59044092,14411657.33107742 4431518.41205522,14411425.50823785 4431424.8113351,14411192.68352286 4431333.64892736,14410958.91259219 4431245.06405297,14410724.25110559 4431158.98700603,14410488.58774358 4431075.41772552,14410252.14514514 4430994.49543271,14410014.75633102 4430916.08078755,14409776.58828047 4430840.2433737,14409537.64099348 4430766.98313591,14409297.91447006 4430696.30002081,14409057.4087102 4430628.26361475,14408816.23503339 4430562.80422942,14408574.3377799 4430499.92181712,14408331.82826921 4430439.75560529,14408088.65084157 4430382.09663901,14407844.86115674 4430327.15378504,14407600.51487444 4430274.8573657,14407355.6119947 4430225.13770662,14407110.20817725 4430178.1340414,14406864.30342209 4430133.77669936,14406617.95338895 4430092.06564731,14406371.15807787 4430053.07048814,14406123.97314856 4430016.72155806,14405876.39860104 4429983.0188299,14405628.49009504 4429952.03191187,14405380.24763057 4429923.69114693,14405131.72686738 4429898.06614697,14404882.92780545 4429875.0872594,14404633.90610455 4429854.89373261,14404384.7174244 4429837.27665267,14404135.30610528 4429822.44490449,14403885.78346667 4429810.2592114,14403636.14950857 4429800.85882914,14403386.40423097 4429794.10448556,14403136.60329363 4429789.99617558,14402886.8023563 4429788.67316083,14402636.9457592 4429789.99617558,14402387.14482186 4429794.10448556,14402137.45520403 4429800.85882914,14401887.76558617 4429810.2592114,14401638.24294755 4429822.44490449,14401388.83162843 4429837.27665267,14401139.64294829 4429854.89373261,14400890.62124738 4429875.0872594,14400641.82218547 4429898.06614697,14400393.30142228 4429923.69114693,14400145.0589578 4429952.03191187,14399897.15045181 4429983.0188299,14399649.57590428 4430016.72155806,14399402.39097497 4430053.07048814,14399155.59566388 4430092.06564731,14398909.24563076 4430133.77669936,14398663.3408756 4430178.1340414,14398417.93705815 4430225.13770662,14398173.0341784 4430274.8573657,14397928.68789611 4430327.15378504,14397684.95387102 4430382.09663901,14397441.77644338 4430439.75560529,14397199.21127293 4430499.92181712,14396957.31401944 4430562.80422942,14396716.14034265 4430628.26361475,14396475.63458278 4430696.30002081,14396235.90805936 4430766.98313591,14395996.96077238 4430840.2433737,14395758.79272182 4430916.08078755,14395521.45956745 4430994.49543271,14395284.96130926 4431075.41772552,14395049.35360699 4431158.98700603,14394814.63646066 4431245.06405297,14394580.86552999 4431333.64892736,14394348.09647475 4431424.8113351,14394116.27363516 4431518.41205522,14393885.452671 4431614.59044092,14393655.689242 4431713.20727232,14393426.98334816 4431814.33226306,14393199.39064924 4431917.96548487,14392972.96680497 4432023.96771721,14392747.60049586 4432132.47832653,14392523.45870115 4432243.42774136,14392300.54142084 4432356.74638899,14392078.79299517 4432472.50399533,14391858.32474366 4432590.70064022,14391639.13666628 4432711.1971021,14391421.28442281 4432834.13276405,14391204.71235347 4432959.36840452,14390989.53177776 4433086.973759,14390775.68703594 4433216.87925817,14390563.28944752 4433349.08498652,14390352.28335271 4433483.59103008,14390142.7244113 4433620.39747637,14389934.66828301 4433759.434756,14389728.11496784 4433900.70295669,14389523.0644658 4434044.2718279,14389319.62809637 4434190.00214058,14389117.69454008 4434337.96364606,14388917.37511639 4434488.01711134,14388718.66982533 4434640.30195361,14388521.63432662 4434794.74860383,14388326.21296054 4434951.2874902,14388132.51704655 4435109.9187054,14387940.54658468 4435270.64234336,14387750.30157491 4435433.45849924,14387561.78201725 4435598.36726945,14387375.04357146 4435765.22940847,14387190.14189725 4435934.18435395,14387007.02133488 4436105.0928583,14386825.79320388 4436277.95501602,14386646.40184447 4436452.77092272,14386468.84725665 4436629.54067506,14386293.24075993 4436808.2643708,14386119.58235428 4436988.80274955,14385947.81637999 4437171.29526569,14385778.05415653 4437355.60265613,14385610.2956839 4437541.72501553,14385444.48530237 4437729.66243957,14385280.73433141 4437919.41502481,14385118.98711129 4438110.91318178,14384959.35496149 4438304.15700513,14384801.78222227 4438499.07690084,14384646.32455338 4438695.74265227,14384492.92629506 4438894.08466451,14384341.69876682 4439094.10303172,14384192.64196866 4439295.65845928,14384045.75590055 4439498.89042721,14383901.04056252 4439703.72933454,14383758.55161431 4439910.10557567,14383618.23339616 4440118.0192405,14383480.19722757 4440327.40071799,14383344.3874488 4440538.3197982,14383210.8597196 4440750.63716429,14383079.66969971 4440964.42260614,14382950.70606961 4441179.67621269,14382824.08014885 4441396.25865629,14382699.79193736 4441614.23972854,14382577.8414352 4441833.54980436,14382458.22864235 4442054.11925342,14382341.06487828 4442276.01786887,14382226.23882354 4442499.17601843,14382113.80613783 4442723.59378181,14382003.76682119 4442949.2015203,14381896.17653333 4443175.99931003,14381791.03527428 4443403.91750571,14381688.34304403 4443633.02590309,14381588.09984256 4443863.18512978,14381490.36132965 4444094.46498078,14381395.07184553 4444326.79580167,14381302.3427097 4444560.1079323,14381212.06260266 4444794.47116859,14381124.34284392 4445029.74611536,14381039.12777372 4445266.00256757,14380956.4730518 4445503.10111973,14380876.32301843 4445741.1813029,14380798.78899309 4445980.10370587,14380723.81531605 4446219.79864536,14380651.40198729 4446460.33591588,14380581.5490068 4446701.64583144,14380514.31203437 4446943.72844495,14380449.69106996 4447186.51406281,14380387.68611359 4447430.00273346,14380328.29716526 4447674.12475561,14380271.52422495 4447918.88017315,14380217.36729268 4448164.26903014,14380165.88202818 4448410.22161594,14380117.01277174 4448656.73796998,14380070.81518304 4448903.74837367,14380027.28926216 4449151.25286173,14379986.37934928 4449399.25146894,14379948.19676394 4449647.67446717,14379912.63018663 4449896.52188643,14379879.73527711 4450145.72399053,14379849.5676951 4450395.21103673,14379822.01612113 4450645.1225844,14379797.19187468 4450895.24935013,14379775.09495576 4451145.66112216,14379755.61404487 4451396.28814632,14379738.8604615 4451647.20021419,14379724.83420566 4451898.18801272,14379713.4796176 4452149.32132688,14379704.79669732 4452400.60016714,14379698.84110457 4452652.02454399,14379695.61283933 4452903.38511458,14379695.05624188 4453154.89123277,14379697.22697195 4453406.33354578,14379702.06936979 4453657.71204914,14379709.63909517 4453909.09652951,14379719.88048833 4454160.34740193,14379732.849209 4454411.46465698,14379748.48959746 4454662.44828525,14379766.85731344 4454913.29827733,14379787.95235695 4455163.87502507,14379811.66340849 4455414.24831016,14379838.10178754 4455664.34831559,14379867.26749413 4455914.10521773,14379899.04920876 4456163.58879834,14379933.5582509 4456412.72923054,14379970.73896082 4456661.45668091,14380010.59133853 4456909.8409313,14380053.11538402 4457157.74233253,14380098.25543752 4457405.16085072,14380146.12281857 4457652.02663624,14380196.60620764 4457898.47928531,14380249.7612645 4458144.30931196,14380305.53232939 4458389.51667282,14380363.91940231 4458634.17114692,14380424.978143 4458878.20287204,14380488.65289174 4459121.4721541,14380554.94364851 4459364.11859473,14380623.85041332 4459606.00249369,14380695.3175264 4459847.19362899,14380769.40064752 4460087.55228945,14380846.09977667 4460327.07841833,14380925.30359438 4460565.77195909,14381007.12342011 4460803.63285535,14381091.50359413 4461040.52137454,14381178.3884567 4461276.57713082,14381267.83366755 4461511.66038581,14381359.83922669 4461745.70123175,14381454.29381463 4461978.76944383,14381551.30875086 4462210.86495772,14381650.77271588 4462441.84801441,14381752.74136945 4462671.71854096,14381857.15905181 4462900.47646477,14381964.02576297 4463128.12171361,14382073.39716267 4463354.65421555,14382185.16193144 4463579.86433402,14382299.32006924 4463803.96155393,14382415.92723585 4464026.73623056,14382534.9277715 4464248.3279991,14382656.32167621 4464468.52720246,14382780.05329023 4464687.40361588,14382906.12261356 4464905.0270209,14383034.52964618 4465121.18774445,14383165.27438812 4465335.95556334,14383298.30117962 4465549.33039258,14383433.66568042 4465761.17240885,14383571.25657105 4465971.62126157,14383711.18517098 4466180.53712297,14383853.28450096 4466387.91990209,14383997.61022079 4466593.76950854,14384144.16233041 4466798.01597637,14384292.94082986 4467000.72909013,14384443.83439962 4467201.76900355,14384596.95435921 4467401.13562099,14384752.13372938 4467598.89872927,14384909.48382961 4467794.91847241,14385068.94900017 4467989.26463747,14385230.47358132 4468181.79736104,14385394.05757304 4468372.65631733,14385559.75663508 4468561.63175155,14385727.40378822 4468748.86334094,14385897.11035193 4468934.28110223,14386068.76500673 4469117.81504811,14386242.42341237 4469299.53497313,14386417.97424936 4469479.30099541,14386595.52883716 4469657.18291033,14386774.97585633 4469833.11072613,14386956.25964709 4470007.08434505,14387139.43586918 4470179.10367039,14387324.44886289 4470349.09870671,14387511.29862818 4470517.06935611,14387699.98516507 4470683.01552186,14387890.39715408 4470846.93710842,14388082.59025494 4471008.76411714,14388276.50880789 4471168.49645162,14388472.09715321 4471326.13401665,14388669.4666104 4471481.60681095,14388868.45020019 4471634.91473874,14389069.0479226 4471786.05770561,14389271.31543736 4471935.03561846,14389475.14142501 4472081.84838549,14389680.52588553 4472226.42600398,14389887.52447866 4472368.69846874,14390095.97022517 4472508.80551476,14390305.97444454 4472646.60722554,14390517.42581731 4472782.10351069,14390730.32434345 4472915.2942813,14390944.67002297 4473046.17944997,14391160.40719613 4473174.75893082,14391377.48020317 4473300.96272006,14391595.94470387 4473424.79073235,14391815.74503843 4473546.24288394,14392036.82554715 4473665.31909271,14392259.18623001 4473781.94935552,14392482.77142726 4473896.20351452,14392707.58113891 4474008.01156832,14392933.55970523 4474117.37343909,14393160.76278594 4474224.21912509,14393389.07906156 4474328.68840229,14393618.50853208 4474430.57141925,14393848.99553778 4474530.00795612,14394080.59573836 4474626.9280154,14394313.19781437 4474721.4014565,14394546.8017658 4474813.21842527,14394781.40759266 4474902.58864237,14395016.90397542 4474989.37218433,14395253.40223362 4475073.56898719,14395490.73538799 4475155.2489207,14395728.95909829 4475234.27206181,14395968.01770477 4475310.77821624,14396207.91120743 4475384.62746268,14396448.58394652 4475455.88967897,14396689.9802623 4475524.49487844,14396932.15581452 4475590.51294379,14397174.99928369 4475653.94382638,14397418.5106698 4475714.64760861,14397662.63431311 4475772.76411498,14397907.42587337 4475828.15343029,14398152.77403108 4475880.9553846,14398398.67878624 4475931.03006526,14398645.0844791 4475978.44737056,14398892.04676943 4476023.2072646,14399139.39867797 4476065.30971353,14399387.25152422 4476104.61480944,14399635.49398869 4476141.33233579,14399884.12607138 4476175.32238855,14400133.09211254 4476206.58494132,14400382.44777192 4476235.11996981,14400632.02607028 4476260.9973909,14400881.88266736 4476284.14724583,14401131.96190342 4476304.56951657,14401382.26377848 4476322.26418728,14401632.7882925 4476337.23124421,14401883.36846628 4476349.54061538,14402134.11561929 4476359.05241205,14402384.97409179 4476365.90650614,14402635.88822405 4476369.96301291,14402886.8023563 4476371.36180871,14403137.71648855 4476369.96301291,14403388.57496104 4476365.90650614,14403639.43343355 4476359.05241205,14403890.18058655 4476349.54061538,14404140.81642008 4476337.23124421,14404391.28527437 4476322.26418728,14404641.58714941 4476304.56951657,14404891.66638549 4476284.14724583,14405141.52298257 4476260.9973909,14405391.15694067 4476235.11996981,14405640.4569403 4476206.58494132,14405889.42298146 4476175.32238855,14406138.05506415 4476141.33233579,14406386.29752861 4476104.61480944,14406634.15037486 4476065.30971353,14406881.55794316 4476023.2072646,14407128.46457373 4475978.44737056,14407374.92592635 4475931.03006526,14407620.83068151 4475880.9553846,14407866.17883922 4475828.15343029,14408110.91473973 4475772.76411498,14408355.09404278 4475714.64760861,14408598.6054289 4475653.94382638,14408841.44889806 4475590.51294379,14409083.56879053 4475524.49487844,14409324.96510632 4475455.88967897,14409565.63784542 4475384.62746268,14409805.53134808 4475310.77821624,14410044.58995456 4475234.27206181,14410282.81366486 4475155.2489207,14410520.20247897 4475073.56898719,14410756.64507742 4474989.37218433,14410992.19711994 4474902.58864237,14411226.74728703 4474813.21842527,14411460.40689821 4474721.4014565,14411693.00897422 4474626.9280154,14411924.55351507 4474530.00795612,14412155.09618051 4474430.57141925,14412384.52565103 4474328.68840229,14412612.84192664 4474224.21912509,14412839.98934761 4474117.37343909,14413066.02357367 4474008.01156832,14413290.83328532 4473896.20351452,14413514.41848258 4473781.94935552,14413736.77916544 4473665.31909271,14413957.80401442 4473546.24288394,14414177.60434898 4473424.79073235,14414396.06884966 4473300.96272006,14414613.14185671 4473174.75893082,14414828.87902986 4473046.17944997,14415043.2247094 4472915.2942813,14415256.12323554 4472782.10351069,14415467.57460829 4472646.60722554,14415677.57882768 4472508.80551476,14415886.08023393 4472368.69846874,14416093.02316732 4472226.42600398,14416298.40762784 4472081.84838549,14416502.28927522 4471935.03561846,14416704.50113025 4471786.05770561,14416905.1545124 4471634.91473874,14417104.13810219 4471481.60681095,14417301.45189962 4471326.13401665,14417497.0959047 4471168.49645162,14417691.01445765 4471008.76411714,14417883.15189876 4470846.93710842,14418073.61954751 4470683.01552186,14418262.25042466 4470517.06935611,14418449.10018996 4470349.09870671,14418634.11318366 4470179.10367039,14418817.28940576 4470007.08434505,14418998.62885626 4469833.11072613,14419178.02021567 4469657.18291033,14419355.57480349 4469479.30099541,14419531.18130021 4469299.53497313,14419704.7840461 4469117.81504811,14419876.49436065 4468934.28110223,14420046.14526463 4468748.86334094,14420213.84807751 4468561.63175155,14420379.4914798 4468372.65631733,14420543.07547153 4468181.79736104,14420704.60005266 4467989.26463747,14420864.06522322 4467794.91847241,14421021.41532346 4467598.89872927,14421176.65035338 4467401.13562099,14421329.71465321 4467201.76900355,14421480.66388274 4467000.72909013,14421629.38672243 4466798.01597637,14421775.93883206 4466593.76950854,14421920.26455187 4466387.91990209,14422062.41954162 4466180.53712297,14422202.2924818 4465971.62126157,14422339.88337241 4465761.17240885,14422475.24787322 4465549.33039258,14422608.27466472 4465335.95556334,14422739.01940666 4465121.18774445,14422867.42643929 4464905.0270209,14422993.55142236 4464687.40361588,14423117.28303637 4464468.52720246,14423238.62128134 4464248.3279991,14423357.621817 4464026.73623056,14423474.2289836 4463803.96155393,14423588.38712141 4463579.86433402,14423700.20754992 4463354.65421555,14423809.52328988 4463128.12171361,14423916.39000103 4462900.47646477,14424020.86334314 4462671.71854096,14424122.77633696 4462441.84801441,14424222.29596173 4462210.86495772,14424319.25523821 4461978.76944383,14424413.76548589 4461745.70123175,14424505.71538528 4461511.66038581,14424595.16059615 4461276.57713082,14424682.10111845 4461040.52137454,14424766.42563274 4460803.63285535,14424848.24545846 4460565.77195909,14424927.50493591 4460327.07841833,14425004.14840531 4460087.55228945,14425078.23152645 4459847.19362899,14425149.69863953 4459606.00249369,14425218.60540434 4459364.11859473,14425284.89616109 4459121.4721541,14425348.57090983 4458878.20287204,14425409.62965054 4458634.17114692,14425468.01672346 4458389.51667282,14425523.84344809 4458144.30931196,14425576.9428452 4457898.47928531,14425627.48189401 4457652.02663624,14425675.29361531 4457405.16085072),(14403011.257547 4448399.13060769,14403259.83396994 4448412.52352478,14403507.35285772 4448439.30940982,14403753.09063364 4448479.41860923,14403996.32372103 4448532.71176331,14404236.38420292 4448598.97980311,14404472.54850264 4448678.15321583,14404704.14870324 4448769.88350526,14404930.51688776 4448873.96172441,14405150.98513929 4448990.10920314,14405364.88554084 4449117.97754155,14405571.71715473 4449257.21836267,14405770.81206402 4449407.34378584,14405961.5580115 4449568.07522467,14406143.5097192 4449738.78529049,14406316.05492992 4449919.05587785,14406478.69270598 4450108.39911348,14406630.97776938 4450306.18757884,14406772.52050193 4450511.93336702,14406902.81996589 4450725.00901177,14407021.59786258 4450944.85678393,14407128.46457373 4451170.70960273,14407223.03048117 4451402.07943117,14407305.18426537 4451638.19909435,14407374.53630814 4451878.3711337,14407431.03094972 4452121.96781182,14407474.38989138 4452368.29155632,14407504.50181363 4452616.57494983,14407521.31105675 4452866.1202885,14407524.76196095 4453116.22980329,14407514.85452627 4453366.13587187,14407491.58875271 4453615.21037763,14407455.02029998 4453862.61577262,14407405.31614734 4454107.7238082,14407342.58761427 4454349.83638475,14407266.94602028 4454588.18554536,14407178.72532383 4454822.14286154,14407078.09250416 4455051.01005556,14406965.38151973 4455274.08879591,14406840.92632902 4455490.82030395,14406705.0608905 4455700.50616019,14406558.11916266 4455902.58751138,14406400.65774293 4456096.43567162,14406233.0105898 4456281.49173395,14406055.73430071 4456457.33638906,14405869.27415363 4456623.27108712,14405674.24240576 4456778.94631115,14405471.13999481 4456923.87293081,14405260.57917797 4457057.70144449,14405043.17221245 4457179.94274175,14404819.53135544 4457290.2473534,14404590.3245239 4457388.40546344,14404356.21963477 4457473.9978456,14404117.82894524 4457546.88456429,14403875.93169173 4457606.78609457,14403631.14013149 4457653.56258396,14403384.2335009 4457687.07422607,14403135.87971695 4457707.25107852,14402886.8023563 4457713.9534325,14402637.72499564 4457707.25107852,14402389.31555194 4457687.07422607,14402142.40892136 4457653.56258396,14401897.6173611 4457606.78609457,14401655.72010761 4457546.88456429,14401417.32941808 4457473.9978456,14401183.22452894 4457388.40546344,14400954.01769739 4457290.2473534,14400730.37684039 4457179.94274175,14400512.96987487 4457057.70144449,14400302.40905804 4456923.87293081,14400099.36230682 4456778.94631115,14399904.27489921 4456623.27108712,14399717.87041188 4456457.33638906,14399540.53846305 4456281.49173395,14399372.94696966 4456096.43567162,14399215.42989019 4455902.58751138,14399068.54382209 4455700.50616019,14398932.62272383 4455490.82030395,14398808.16753312 4455274.08879591,14398695.45654869 4455051.01005556,14398594.82372901 4454822.14286154,14398506.60303256 4454588.18554536,14398431.01709832 4454349.83638475,14398368.2329055 4454107.7238082,14398318.52875287 4453862.61577262,14398282.01595988 4453615.21037763,14398258.75018631 4453366.13587187,14398248.78709188 4453116.22980329,14398252.2379961 4452866.1202885,14398269.10289895 4452616.57494983,14398299.21482121 4452368.29155632,14398342.57376288 4452121.96781182,14398399.01274471 4451878.3711337,14398468.36478748 4451638.19909435,14398550.51857168 4451402.07943117,14398645.14013885 4451170.70960273,14398751.95119027 4450944.85678393,14398870.72908694 4450725.00901177,14399001.02855092 4450511.93336702,14399142.57128347 4450306.18757884,14399294.85634687 4450108.39911348,14399457.54978266 4449919.05587785,14399630.09499339 4449738.78529049,14399811.99104135 4449568.07522467,14400002.73698882 4449407.34378584,14400201.8318981 4449257.21836267,14400408.663512 4449117.97754155,14400622.6195733 4448990.10920314,14400843.08782482 4448873.96172441,14401069.45600935 4448769.88350526,14401301.0005502 4448678.15321583,14401537.16484991 4448598.97980311,14401777.22533182 4448532.71176331,14402020.45841919 4448479.41860923,14402266.19619512 4448439.30940982,14402513.71508291 4448412.52352478,14402762.29150584 4448399.13060769,14403011.257547 4448399.13060769)))";
        // Make wkt36.836819, 127.512522
        // 36.830705, 127.466691

      //  double lenght = distance(36.822830, 127.636255, 36.826592, 127.644795);



        Geometry poly =  ogr.CreateGeometryFromWkt(wkt);
        double area = poly.GetArea();
        String json = poly.ExportToJson();



        return  area;
    }
}
